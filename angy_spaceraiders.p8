pico-8 cartridge // http://www.pico-8.com
version 32
__lua__
angys = {}
num_angy = {row=5,col=6}
ab = {l=10, t=1, r=128, b=70}

ship = {x=60, y=115}
lasers = {}


function _init()
	for i=0, num_angy.col-1 do
		for j=0, num_angy.row-1 do
			add(angys, make_angy(
				ab.l+i*(ab.r-ab.l)/num_angy.col,
				ab.t+j*(ab.b-ab.t)/num_angy.row 
				))
	 end
	end
end

function make_angy(x,y)
	return {
		x=x, y=y, n=2, die=-1,
	}
end


function _update()
--	if (btn(⬆️)) ship.y=ship.y-1 check_key()
--	if (btn(⬇️)) ship.y=ship.y+1 check_key()
	if (btn(⬅️)) ship.x=ship.x-1
	if (btn(➡️)) ship.x=ship.x+1
	
	if (btn(⬆️)) laser_shoot()
	
	for laser in all(lasers) do	
		laser.y -=3
		if laser.y < 0 then 
			del(lasers,laser)
		end
	end
	
	for laser in all(lasers) do
		for angy in all(angys) do
			angyboxmaths(laser,angy)
			
		end
	end
	
	for angy in all(angys) do
		if angy.die>0 
				then	angy.die-=1 
		elseif angy.die==0 then
		 del(angys,angy)
		
		end
	end
end

function angyboxmaths(laser,angy)
	if laser.x+3>=angy.x
	 and laser.x+3<=angy.x+7 
		and laser.y+3>=angy.y
		and laser.y+3<=angy.y+7 then
			del(lasers,laser) 
			angy.die=5
			angy.n=5
			sfx(2)
	end
	
	
end

function laser_shoot()
	add(lasers,{x=ship.x, y=ship.y})
	sfx(0)
end

function _draw()
	cls(2)
	for angy in all(angys) do 
		spr(angy.n, angy.x, angy.y)
	end 
	spr(3, ship.x, ship.y)
	for laser in all(lasers) do
		spr(1,laser.x, laser.y)
	end
	?#lasers
--	rect(ab.l, ab.t, ab.r, ab.b, 7)
end


__gfx__
000000000000000008888880aa0000aa000000000888888000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000888888880aa00aa0000000008888888800000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000008800008800aaaa00000000008809008800000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000cc00088000088aaaaaaaa00000000889a908800000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000cc00088888888aaaaaaaa000000008999988800000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000008880088800aaaa0000000000899a999800000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000008088080000aa00000000000099aaa9000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000008888880000aa0000000000099acca9000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
010100000000000000000000000000000000000000037050000000000000000000000000036050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
011000000d050230501305017050100501505028050260501a0500f05026050260501505016050300003000030000310003100033000330003300033000320003200030000300002f0002f000000000000000000
011000000a0300a0300a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
